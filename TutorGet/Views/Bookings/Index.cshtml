@model IEnumerable<TutorGet.Models.Booking>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Booking Calendar</h2>
@*<p>
        @Html.ActionLink("Create New", "Create")
    </p>*@

<div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title"><span id="eventTitle"></span></h4>
                </div>
                <div class="modal-body">
                    <button id="btnDelete" class="btn btn-default btn-sm pull-right" 
                            onclick="location.href='@Url.Action("Delete", "Bookings")';return false;">
                    <span class="glyphicon glyphicon-trash"></span> Remove
                    </button>
                     <button id="btnEdit" class="btn btn-default btn-sm pull-right" style="margin-right:5px;
                            "onclick="location.href='@Url.Action("Edit", "Bookings")';return false;">
                    <span class="glyphicon glyphicon-edit"></span> Edit
                    </button>
                    <p id="pDetails"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
<div id="calendar"></div>
<div style="display: none ">
    <table class="table">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Tutor.Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.BookingTime)
            </th>
            <th></th>
        </tr>
        @foreach (var item in Model)
        {
            <tr class="events">
                <td class="title">
                    @Html.DisplayFor(modelItem => item.Tutor.Name)
                </td>
                <td class="start">
                    @Html.DisplayFor(modelItem => item.BookingTime)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                </td>
            </tr>
        }
    </table>
</div>

@section Scripts {

    @Scripts.Render("~/bundles/fullcalendar")

    <script>
                    $('#calender').fullCalendar({                      
                        eventClick: function (calEvent, jsEvent, view) {
                            $('#myModal #eventTitle').text(calEvent.title);
                            var $description = $('<div/>');
                            $description.append($('<p/>').html('<b>Start:</b>' + calEvent.start.format("DD/MM/YYYY HH:mm a")));
                            if (calEvent.end != null) {
                                $description.append($('<p/>').html('<b>End:</b>' + calEvent.end.format("DD/MM/YYYY HH:mm a")));
                            }
                            $('#myModal #pDetails').empty().html($description);

                            $('#myModal').modal("show");
                        }
                    })
        </script>
}
